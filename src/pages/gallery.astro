---
import Layout from '../layouts/Layout.astro';
import { getCollection } from 'astro:content';

const galleries = await getCollection('gallery');
const sortedGalleries = galleries.sort((a, b) => {
  const dateA = a.data.date || new Date(0);
  const dateB = b.data.date || new Date(0);
  return dateB.getTime() - dateA.getTime();
});
---

<Layout
  title="Gallery | GMC Tourism"
  description="Explore our collection of images showcasing the beauty of Gelephu Mindfulness City and Bhutan."
  mainClass="pt-0"
>
  <!-- Hero Section -->
  <div class="relative h-[50vh] w-full overflow-hidden flex items-center justify-center">
    <img
      src="/backgrounds/home-background.jpg"
      alt="Gallery"
      class="absolute h-full w-full object-cover"
    />
    <div class="absolute inset-0 bg-gradient-to-b from-black/50 via-black/30 to-black/60"></div>
    <div class="relative z-10 text-center px-4">
      <h1
        class="gallery-hero-title text-4xl font-bold text-white md:text-5xl lg:text-6xl drop-shadow-sm"
      >
        Gallery
      </h1>
      <p class="gallery-hero-subtitle mt-4 text-lg text-white md:text-xl drop-shadow-sm">
        Visual stories from the Kingdom of Happiness
      </p>
    </div>
  </div>

  <!-- Gallery Grid -->
  <section class="py-16 px-4 sm:px-6 lg:px-8 bg-black text-white min-h-[50vh]">
    <div class="max-w-7xl mx-auto">
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
        {
          sortedGalleries.map((gallery) => (
            <a
              href={`/gallery/${gallery.slug}`}
              class="group relative block overflow-hidden rounded-xl bg-gray-900 aspect-[4/3] transition-transform hover:-translate-y-1"
            >
              <img
                src={gallery.data.coverImage}
                alt={gallery.data.title}
                class="h-full w-full object-cover transition-transform duration-500 group-hover:scale-110 opacity-80 group-hover:opacity-100"
              />
              <div class="absolute inset-0 bg-gradient-to-t from-black/90 via-black/20 to-transparent" />
              <div class="absolute bottom-0 left-0 p-6 w-full">
                <h2 class="text-xl font-bold text-white mb-2">{gallery.data.title}</h2>
                <p class="text-sm text-gray-300 flex items-center gap-2">
                  <i class="fa-regular fa-images" />
                  {gallery.data.images.length} file(s)
                </p>
              </div>
            </a>
          ))
        }
      </div>

      {
        sortedGalleries.length === 0 && (
          <div class="text-center py-20">
            <p class="text-gray-400 text-lg">No galleries found.</p>
          </div>
        )
      }
    </div>
  </section>
</Layout>

<style>
  .gallery-hero-title {
    color: #ffffff !important;
  }

  .gallery-hero-subtitle {
    color: #ffffff !important;
  }

  :global([data-theme='light']) .gallery-hero-title,
  :global([data-theme='light']) .gallery-hero-subtitle {
    color: #ffffff !important;
  }

  :global([data-theme='light']) section {
    background-color: #f8fafc;
    color: #0f172a;
  }

  :global([data-theme='light']) .group {
    background-color: #e2e8f0;
  }
</style>
